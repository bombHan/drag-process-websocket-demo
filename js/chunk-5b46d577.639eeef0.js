(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b46d577"],{4414:function(t,e,i){"use strict";var o=i("5de8"),n=i.n(o);n.a},5350:function(t,e,i){"use strict";var o=i("9970"),n=i.n(o);n.a},"56bb1":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"process"},[i("div",{staticClass:"left"},[i("tree",{attrs:{process:t.process},on:{addCondition:t.addCondition,addChildNode:t.addChildNode,addChildNodeEnd:t.addChildNodeEnd,deleteCondition:t.deleteCondition,deleteChildNode:t.deleteChildNode,clickItem:t.clickItem}})],1),t.visible?i("drawer",{attrs:{visible:t.visible,formData:t.formData,formDataParentConditions:t.formDataParentConditions},on:{save:t.saveFormData,close:t.closeDrawer}}):t._e(),i("a-button",{staticStyle:{position:"absolute",top:"-50px",right:"200px","z-index":"9"},attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")])],1)},n=[],s=(i("5ab2"),i("e10e"),i("13c1")),r=(i("6d57"),i("c904"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tree-wrap"},[t.process.type&&"end"!==t.process.type&&"conditions"!==t.process.type?i("div",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center",background:"#fff"}},[i("div",{staticClass:"tree-item"},["originator"===t.process.type?i("div",{staticStyle:{position:"absolute",left:"0",top:"0px",width:"100%",background:"#fff","z-index":"999",height:"40px"}}):t._e(),i("div",{staticClass:"tree-item-border"}),i("div",{staticClass:"tree-item-content",style:"originator"===t.process.type?"cursor: default":"",on:{click:function(e){return t.clickItem(t.process)}}},["originator"!==t.process.type?i("a-icon",{staticClass:"down-icon",attrs:{type:"caret-down"}}):t._e(),"originator"!==t.process.type?i("a-icon",{staticClass:"tree-item-content-close",staticStyle:{color:"#fff"},attrs:{type:"close"},on:{click:function(e){return e.stopPropagation(),t.deleteChildNode(t.process,t.parent)}}}):t._e(),i("div",{staticClass:"tree-item-content-title",staticStyle:{color:"#fff"},style:"originator"===t.process.type?"background:#576a95":"approval"===t.process.type?"background:#ff943e;":"background:#3296fa"},[t._v("\n          "+t._s(t.process.title)+"\n        ")]),i("div",{staticClass:"tree-item-content-content"},[t.process.content?i("div",[t._v(t._s(t.process.content))]):i("div",{staticStyle:{color:"#999"}},[t._v("请设置")])])],1)]),i("div",{staticClass:"add-button"},[i("a-popover",{attrs:{title:null,trigger:"click",placement:"bottom",getPopupContainer:function(t){return t.parentNode}}},[i("template",{slot:"content"},[i("div",{staticClass:"add-node"},[i("div",{staticClass:"add-node-item",on:{click:function(e){return t.addChildNode(t.process,"CCperson")}}},[i("a-icon",{staticStyle:{"font-size":"30px","margin-bottom":"10px"},attrs:{type:"user"}}),t._v("\n              抄送人\n            ")],1),i("div",{staticClass:"add-node-item",on:{click:function(e){return t.addChildNode(t.process,"approval")}}},[i("a-icon",{staticStyle:{"font-size":"30px","margin-bottom":"10px"},attrs:{type:"user"}}),t._v("\n              审批人\n            ")],1),i("div",{staticClass:"add-node-item",on:{click:function(e){return t.addChildNode(t.process,"condition")}}},[i("a-icon",{staticStyle:{"font-size":"30px","margin-bottom":"10px"},attrs:{type:"user"}}),t._v("\n              分支\n            ")],1)])]),i("a-icon",{staticClass:"plus",attrs:{type:"plus-circle"}})],2),i("div",{staticClass:"tree-item-border"})],1)]):t._e(),t.process.conditions&&t.process.conditions.length>0?i("div",{staticClass:"tree"},[i("a-icon",{staticClass:"addcondition-button-down-icon",attrs:{type:"caret-down"}}),i("div",{staticClass:"addcondition-button",on:{click:function(e){return t.addCondition(t.process)}}},[t._v("\n      添加条件\n    ")]),t._l(t.process.conditions,(function(e,o){return i("div",{key:o,staticStyle:{display:"flex","flex-direction":"column","align-items":"center",position:"relative"}},[i("div",{staticClass:"tree-item"},[i("a-icon",{staticClass:"condition-down-icon",attrs:{type:"caret-down"}}),i("div",{staticClass:"tree-item-border"}),i("div",{staticClass:"tree-item-content",on:{click:function(i){return t.clickItem(e,t.process)}}},[i("a-icon",{staticClass:"tree-item-content-close",attrs:{type:"close"},on:{click:function(e){return e.stopPropagation(),t.deleteCondition(o,t.process,t.parent)}}}),i("div",{staticClass:"tree-item-content-title"},[i("div",{staticStyle:{width:"110px","text-align":"left","word-break":"break-all"}},[t._v("\n              "+t._s(e.title)+"\n            ")]),i("span",{staticStyle:{color:"#999"}},[t._v("优先级"+t._s(e.sort+1))])]),i("div",{staticClass:"tree-item-content-content"},[e.content?i("div",[t._v(t._s(e.content))]):i("div",{staticStyle:{color:"#999"}},[t._v("请设置")])])],1)],1),i("div",{staticClass:"add-button"},[i("a-popover",{attrs:{title:null,trigger:"click",placement:"bottom",getPopupContainer:function(t){return t.parentNode}}},[i("template",{slot:"content"},[i("div",{staticClass:"add-node"},[i("div",{staticClass:"add-node-item",on:{click:function(i){return t.addChildNode(e,"CCperson")}}},[i("a-icon",{staticStyle:{"font-size":"30px","margin-bottom":"10px"},attrs:{type:"user"}}),t._v("\n                抄送人\n              ")],1),i("div",{staticClass:"add-node-item",on:{click:function(i){return t.addChildNode(e,"approval")}}},[i("a-icon",{staticStyle:{"font-size":"30px","margin-bottom":"10px"},attrs:{type:"user"}}),t._v("\n                审批人\n              ")],1),i("div",{staticClass:"add-node-item",on:{click:function(i){return t.addChildNode(e,"condition")}}},[i("a-icon",{staticStyle:{"font-size":"30px","margin-bottom":"10px"},attrs:{type:"user"}}),t._v("\n                分支\n              ")],1)])]),i("a-icon",{staticClass:"plus",attrs:{type:"plus-circle"}})],2),i("div",{staticClass:"tree-item-border"})],1),e.childNode?i("tree",{attrs:{process:e.childNode,parent:e},on:{addCondition:t.addCondition,addChildNode:t.addChildNode,deleteCondition:t.deleteCondition,deleteChildNode:t.deleteChildNode,clickItem:t.clickItem}}):t._e(),i("div",{staticClass:"condition-vertival"}),0===o?i("div",{staticClass:"border-bottom-right"}):o===t.process.conditions.length-1?i("div",{staticClass:"border-bottom-left"}):i("div",{staticClass:"border-bottom-whole"}),0===o?i("div",{staticClass:"border-top-right"}):o===t.process.conditions.length-1?i("div",{staticClass:"border-top-left"}):i("div",{staticClass:"border-top-whole"})],1)}))],2):t._e(),t.process.conditions&&t.process.conditions.length>0?i("div",{staticClass:"add-button"},[i("a-popover",{attrs:{title:null,trigger:"click",placement:"bottom",getPopupContainer:function(t){return t.parentNode}}},[i("template",{slot:"content"},[i("div",{staticClass:"add-node"},[i("div",{staticClass:"add-node-item",on:{click:function(e){return t.addChildNode(t.process,"CCperson")}}},[i("a-icon",{staticStyle:{"font-size":"30px","margin-bottom":"10px"},attrs:{type:"user"}}),t._v("\n            抄送人\n          ")],1),i("div",{staticClass:"add-node-item",on:{click:function(e){return t.addChildNode(t.process,"approval")}}},[i("a-icon",{staticStyle:{"font-size":"30px","margin-bottom":"10px"},attrs:{type:"user"}}),t._v("\n            审批人\n          ")],1),i("div",{staticClass:"add-node-item",on:{click:function(e){return t.addChildNode(t.process,"condition")}}},[i("a-icon",{staticStyle:{"font-size":"30px","margin-bottom":"10px"},attrs:{type:"user"}}),t._v("\n            分支\n          ")],1)])]),i("a-icon",{staticClass:"plus",attrs:{type:"plus-circle"}})],2),i("div",{staticClass:"tree-item-border"})],1):t._e(),t.process.childNode?i("tree",{attrs:{process:t.process.childNode,parent:t.process},on:{addCondition:t.addCondition,addChildNode:t.addChildNode,deleteCondition:t.deleteCondition,deleteChildNode:t.deleteChildNode,clickItem:t.clickItem}}):t._e(),"end"===t.process.type?i("div",{staticClass:"end-item"},[i("a-icon",{staticClass:"end-item-down-icon",attrs:{type:"caret-down"}}),t._v("\n    流程结束\n  ")],1):t._e()],1)}),c=[],a={name:"tree",props:{process:{type:Object,default:function(){return{}},required:!0},parent:{type:Object,default:function(){return{}},required:!1}},data:function(){return{}},methods:{addChildNode:function(t,e){this.$emit("addChildNode",t,e)},addCondition:function(t){this.$emit("addCondition",t)},deleteChildNode:function(t,e){this.$emit("deleteChildNode",t,e)},deleteCondition:function(t,e,i){this.$emit("deleteCondition",t,e,i)},clickItem:function(t,e){"originator"!==t.type&&this.$emit("clickItem",t,e)}}},d=a,l=(i("5350"),i("9ca4")),p=Object(l["a"])(d,r,c,!1,null,"a65aec3c",null),u=p.exports,f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-drawer",{attrs:{placement:"right",closable:!1,maskClosable:!1,visible:t.visible,width:"500px"},on:{close:t.close}},[i("div",{attrs:{slot:"title"},slot:"title"},[i("a-form-model",{ref:"form",attrs:{model:t.editData,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[i("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},["originator"===t.editData.type?i("div",[t._v("\n          "+t._s(t.editData.title)+"\n        ")]):i("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{prop:"title",rules:{required:!0,message:"请输入"}}},[i("a-input",{staticStyle:{width:"300px"},model:{value:t.editData.title,callback:function(e){t.$set(t.editData,"title",e)},expression:"editData.title"}})],1),"condition"===t.editData.type?i("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{prop:"sort"}},[i("a-select",{staticStyle:{width:"90px"},model:{value:t.editData.sort,callback:function(e){t.$set(t.editData,"sort",e)},expression:"editData.sort"}},t._l(t.formDataParentConditions,(function(e,o){return i("a-select-option",{key:o,attrs:{value:o}},[t._v("优先级"+t._s(o+1))])})),1)],1):t._e()],1)])],1),"condition"===t.editData.type?i("div",[i("div",{staticClass:"top-title"},[t._v("当审批单同时满足以下条件时，进入此流程")]),t._l(t.editData.content,(function(e,o){return[i("div",{key:o,staticStyle:{display:"flex","align-items":"center","justify-content":"space-between","margin-bottom":"15px"}},[i("div",{staticStyle:{width:"90px"}},[t._v(t._s(e.label)+"：")]),i("a-icon",{staticStyle:{color:"#1890ff","font-size":"18px",width:"30px","margin-left":"10px",cursor:"pointer"},attrs:{type:"delete"},on:{click:function(i){return t.deleteCondition(e)}}})],1)]})),i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("a-button",{attrs:{type:"primary"},on:{click:t.openConditionModal}},[t._v("添加条件")]),i("div",{staticStyle:{"margin-left":"10px"}},[t._v("\n        还有"+t._s(t.canChooseComponentList.length)+"个可用条件\n      ")])],1)],2):"approval"===t.editData.type?i("div",[t._v("审批人")]):"CCperson"===t.editData.type?i("div",[t._v("抄送人")]):t._e(),i("div",{staticStyle:{display:"flex","flex-direction":"row-reverse"}},[i("a-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")]),i("a-button",{staticStyle:{"margin-right":"20px"},on:{click:t.close}},[t._v("取消")])],1),t.conditionModalShow?i("a-modal",{attrs:{maskClosable:!1,title:"选择条件",visible:t.conditionModalShow},on:{cancel:function(){t.conditionModalShow=!1},ok:t.addConditionModalOk}},[i("a-checkbox-group",{model:{value:t.conditionList,callback:function(e){t.conditionList=e},expression:"conditionList"}},t._l(t.requiredComponentList,(function(e,o){return i("a-checkbox",{key:o,attrs:{value:e.id}},[t._v(t._s(e.label))])})),1)],1):t._e()],1)},h=[];i("e697");function m(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function v(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?m(Object(i),!0).forEach((function(e){Object(s["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var C={props:{visible:{type:Boolean,default:!1,required:!0},formData:{type:Object,default:function(){return{}},required:!0},formDataParentConditions:{type:Array,default:function(){return[]},required:!1},componentList:{type:Array,default:function(){return[]},required:!1}},data:function(){var t=this.componentList.filter((function(t){return t.required}));return t.unshift({label:"发起人",id:"originator"}),{labelCol:{span:4},wrapperCol:{span:20},requiredComponentList:t,editData:{},originSort:void 0,conditionModalShow:!1,conditionList:[]}},computed:{canChooseComponentList:function(){var t=this,e=(this.requiredComponentList||[]).filter((function(e){var i=!0;return(t.editData.content||[]).forEach((function(t){e.id===t.id&&(i=!1)})),i}));return e}},created:function(){console.log(this.formData),this.editData=JSON.parse(JSON.stringify(this.formData)),this.originSort=JSON.parse(JSON.stringify(this.formData)).sort},methods:{save:function(){this.originSort>-1?this.$emit("save",this.editData,this.originSort):this.$emit("save",this.editData)},close:function(){this.$emit("close")},openConditionModal:function(){this.conditionModalShow=!0,this.conditionList=(this.editData.content||[]).map((function(t){return t.id}))},addConditionModalOk:function(){var t=this;console.log(this.conditionList);var e=this.conditionList.map((function(e){var i=!1;if((t.editData.content||[]).forEach((function(t){t.id===e&&(i=t)})),i)return i;var o=t.requiredComponentList.find((function(t){return t.id===e}));return v({},o)}));this.editData.content=e,this.conditionModalShow=!1,console.log(this.editData.content)},deleteCondition:function(t){console.log(t),this.editData.content=this.editData.content}}},y=C,b=(i("4414"),Object(l["a"])(y,f,h,!1,null,"4f73f73e",null)),g=b.exports;function N(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function O(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?N(Object(i),!0).forEach((function(e){Object(s["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):N(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var S={components:{Tree:u,drawer:g},data:function(){return{visible:!1,formData:{},formDataParentConditions:[],currentProcess:{},process:{title:"发起人",content:"所有人",type:"originator",childNode:{conditions:[{title:"条件1",content:[{id:"componentId1"}],sort:0,type:"condition",childNode:{title:"222",content:"222",type:"approval"}},{title:"条件2",content:[{id:"componentId1"}],type:"condition",sort:1}],childNode:{title:"222",content:"222",type:"approval",childNode:{type:"end"}}}}}},methods:{clickItem:function(t,e){console.log(t,e),this.formData=JSON.parse(JSON.stringify(t)),e&&(this.formDataParentConditions=e.conditions),this.currentProcess=t,this.visible=!0},closeDrawer:function(){this.visible=!1},saveFormData:function(t,e){console.log(t,e,this.currentProcess),"condition"!==this.currentProcess.type?this.currentProcess=Object.assign(this.currentProcess,t):(this.currentProcess=Object.assign(this.currentProcess,t),this.formDataParentConditions.splice(e,1),this.formDataParentConditions.splice(this.currentProcess.sort,0,this.currentProcess),this.formDataParentConditions.forEach((function(t,e){t.sort=e})),console.log(this.formDataParentConditions)),this.closeDrawer()},addCondition:function(t){var e=t.conditions.length;t.conditions.push({title:"条件".concat(e+1),content:"",sort:e,type:"condition"})},deleteCondition:function(t,e,i){console.log("--删除所在位置--",t,"删除对象所在的对象节点",e,"删除对象所在的对象节点的父对象",i),e.conditions.length<3?e.content?delete e.conditions:i.childNode=e.childNode:(e.conditions.splice(t,1),e.conditions=e.conditions.map((function(t,e){return O(O({},t),{},{sort:e})}))),this.process=JSON.parse(JSON.stringify(this.process)),console.log(this.process)},addChildNode:function(t,e){var i=JSON.parse(JSON.stringify(t));"condition"===e?t.childNode={conditions:[{title:"条件1",content:"",sort:0,type:"condition"},{title:"条件2",content:"",sort:1,type:"condition"}],childNode:O({},i.childNode)}:(delete t.conditions,t.childNode={title:"approval"===e?"审批人":"抄送人",type:e,content:"",childNode:i.childNode,conditions:i.conditions}),this.process=JSON.parse(JSON.stringify(this.process)),console.log(t,this.process)},addChildNodeEnd:function(t,e){var i=JSON.parse(JSON.stringify(t.childNode||{}));console.log(i,e),t.childNode="condition"===e?{conditions:[{title:"条件1",content:"",sort:0},{title:"条件2",content:"",sort:1}],childNode:O({},i)}:{title:"approval"===e?"审批人":"抄送人",type:e,content:"",childNode:O({},i)},this.process=JSON.parse(JSON.stringify(this.process)),console.log(t,this.process)},deleteChildNode:function(t,e){t.conditions&&t.conditions.length>0?(e.childNode={conditions:t.conditions,childNode:t.childNode},console.log(e.childNode)):e.childNode=t.childNode,this.process=JSON.parse(JSON.stringify(this.process)),console.log(this.process)},save:function(){console.log(this.process)}}},_=S,k=(i("e8bf"),Object(l["a"])(_,o,n,!1,null,"770fc97b",null));e["default"]=k.exports},"5de8":function(t,e,i){},9970:function(t,e,i){},cac9:function(t,e,i){},e8bf:function(t,e,i){"use strict";var o=i("cac9"),n=i.n(o);n.a}}]);
//# sourceMappingURL=chunk-5b46d577.639eeef0.js.map