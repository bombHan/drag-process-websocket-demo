(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54d5164b"],{1439:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sku"},[a("div",{staticStyle:{"font-weight":"bold",margin:"20px 0"}},[t._v("sku算法-实现商品多规格")]),a("a-form-model",{ref:"form",attrs:{model:t.formData}},[a("div",{staticClass:"standard-list"},[t._l(t.formData.standardsList,(function(e,n){return a("div",{key:n,staticClass:"standard"},[t.formData.standardsList.length>1?a("a-icon",{staticStyle:{position:"absolute",right:"-5px",top:"-5px","z-index":"99",cursor:"pointer"},attrs:{type:"close-circle"},on:{click:function(e){return t.deleteStandard(n)}}}):t._e(),a("a-form-model-item",{attrs:{label:"规格名","label-col":{span:4},"wrapper-col":{span:18},rules:[{validator:function(a,r,o){t.validateName(a,r,o,e.name,n,t.formData.standardsList)},trigger:["change","blur"]},{required:!0,message:"请输入规格名"}],prop:"standardsList."+n+".name"}},[a("a-input",{attrs:{placeholder:"请输入规格名"},model:{value:e.name,callback:function(a){t.$set(e,"name","string"===typeof a?a.trim():a)},expression:"item.name"}})],1),a("a-row",[a("a-col",{staticStyle:{"text-align":"right",height:"40px","line-height":"40px"},attrs:{span:4}},[t._v("规格值：")]),a("a-col",{staticStyle:{display:"flex","flex-wrap":"wrap"},attrs:{span:18}},t._l(e.children,(function(r,o){return a("div",{key:o,staticStyle:{width:"25%",position:"relative"}},[e.children.length>2?a("a-icon",{staticStyle:{position:"absolute",right:"5px",top:"0","z-index":"99",cursor:"pointer"},attrs:{type:"close-circle"},on:{click:function(e){return t.deleteStandardValue(n,o)}}}):t._e(),a("a-form-model-item",{attrs:{label:"规格值","label-col":{span:0},"wrapper-col":{span:20},rules:[{validator:function(a,n,s){t.validateName(a,n,s,r.name,o,e.children)},trigger:["change","blur"]},{required:!0,message:"请输入规格值"}],prop:"standardsList."+n+".children."+o+".name"}},[a("a-input",{attrs:{placeholder:"请输入规格值"},model:{value:r.name,callback:function(e){t.$set(r,"name","string"===typeof e?e.trim():e)},expression:"child.name"}})],1)],1)})),0)],1),a("a-row",[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:4}}),a("a-col",{attrs:{span:18}},[a("a-button",{on:{click:function(a){return t.addStandardChild(e)}}},[t._v("添加规格值")])],1)],1)],1)})),a("a-button",{on:{click:t.addStandards}},[t._v("添加规格")])],2),a("div",{staticClass:"goods"},[a("a-table",{attrs:{columns:t.columns,dataSource:t.formData.goodsList,rowKey:function(t,e){return e},pagination:!1,bordered:""},scopedSlots:t._u([{key:"price",fn:function(e,n,r){return[a("a-form-model-item",{attrs:{"label-col":{span:0},"wrapper-col":{span:20},rules:[{required:!0,message:"请输入现价"}],prop:"goodsList."+r+".price"}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入现价"},model:{value:t.formData.goodsList[r].price,callback:function(e){t.$set(t.formData.goodsList[r],"price",e)},expression:"formData.goodsList[index].price"}})],1)]}},{key:"cost",fn:function(e,n,r){return[a("a-form-model-item",{attrs:{"label-col":{span:0},"wrapper-col":{span:20},rules:[{required:!0,message:"请输入成本"}],prop:"goodsList."+r+".cost"}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入成本"},model:{value:t.formData.goodsList[r].cost,callback:function(e){t.$set(t.formData.goodsList[r],"cost",e)},expression:"formData.goodsList[index].cost"}})],1)]}},{key:"stock",fn:function(e,n,r){return[a("a-form-model-item",{attrs:{"label-col":{span:0},"wrapper-col":{span:20},rules:[{required:!0,message:"请输入库存"}],prop:"goodsList."+r+".stock"}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入库存"},model:{value:t.formData.goodsList[r].stock,callback:function(e){t.$set(t.formData.goodsList[r],"stock",e)},expression:"formData.goodsList[index].stock"}})],1)]}}])})],1)]),a("a-button",{staticStyle:{position:"absolute",right:"20px",top:"20px"},attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")])],1)},r=[],o=(a("5ab2"),a("e10e"),a("13c1"));a("cc57"),a("6d57");function s(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?s(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var c={name:"sku",data:function(){return{formData:{standardsList:[{name:"",children:[{name:""},{name:""}]}],goodsList:[]},columns:[{title:"现价",dataIndex:"price",scopedSlots:{customRender:"price"},width:100,align:"center"},{title:"成本",dataIndex:"cost",scopedSlots:{customRender:"cost"},width:100,align:"center"},{title:"库存",dataIndex:"stock",scopedSlots:{customRender:"stock"},width:100,align:"center"}]}},watch:{"formData.standardsList":{handler:function(t,e){console.log("formData.standardsList----------changed",t),this.formData.goodsList=this.getSkuList(t)},deep:!0}},created:function(){},methods:{addStandards:function(){var t={name:"",children:[{name:""},{name:""}]},e=!0;this.formData.standardsList.forEach((function(t){t.name||(e=!1),t.children&&t.children.forEach((function(t){t.name||(e=!1)}))})),e?this.formData.standardsList.length<4?this.formData.standardsList.push(t):this.$message.error("最多添加4个规格"):this.$message.error("请先完成已添加的规格后再操作")},deleteStandard:function(t){this.formData.standardsList=this.formData.standardsList.filter((function(e,a){return t!==a}))},addStandardChild:function(t){console.log(t);var e={name:""};t.children.length<4?t.children.push(e):this.$message.error("最多添加4个规格值")},deleteStandardValue:function(t,e){this.formData.standardsList[t].children=this.formData.standardsList[t].children.filter((function(t,a){return a!==e}))},validateName:function(t,e,a,n,r,o){var s=!0;o.forEach((function(t,e){r!==e&&t.name===n&&(s=!1)})),s?a():a("规格名重复请重新输入")},getSkuList:function(t){var e=t.map((function(t){var e=t.children.map((function(t){return t.name}));return e})),a=e.reduce((function(t,e){var a=[];return t.forEach((function(t){e.forEach((function(e){a.push(t.concat([e]))}))})),a}),[[]]),n=[];return n=a.map((function(e,a){var n={};return e.forEach((function(e,a){n[t[a].name]=e})),i(i({},n),{},{price:.01,cost:.01,stock:99})})),console.log("---------最终的skuList",n),this.setColumns(e),n},setColumns:function(t){var e=this.$createElement,a=t.map((function(e,a){var n=1,r=t.slice(a);return r.forEach((function(t){n*=t.length})),n}));console.log("--------规格值二位数组",t,"--------spanArr数组",a);var n=this.formData.standardsList.map((function(t,n){var r=a[n+1];return void 0!=r?{title:t.name,dataIndex:n,width:100,align:"center",customRender:function(a,n,o){return console.log(o%r),{children:e("span",[n[t.name]]),attrs:{rowSpan:o%r===0?r:0}}}}:{title:t.name,dataIndex:n,width:100,align:"center",customRender:function(a,n,r){return{children:e("span",[n[t.name]])}}}})),r=[{title:"现价",dataIndex:"price",scopedSlots:{customRender:"price"},width:100,align:"center"},{title:"成本",dataIndex:"cost",scopedSlots:{customRender:"cost"},width:100,align:"center"},{title:"库存",dataIndex:"stock",scopedSlots:{customRender:"stock"},width:100,align:"center"}];this.columns=n.concat(r)},save:function(){var t=this;this.$refs.form.validate((function(e){e&&console.log("---------------formData",t.formData,JSON.stringify(t.formData))}))}}},l=c,d=(a("6cf8"),a("465f"),a("9ca4")),u=Object(d["a"])(l,n,r,!1,null,"a7fefa42",null);e["default"]=u.exports},"1d49":function(t,e,a){},"465f":function(t,e,a){"use strict";var n=a("1d49"),r=a.n(n);r.a},"6cf8":function(t,e,a){"use strict";var n=a("92a8"),r=a.n(n);r.a},"92a8":function(t,e,a){}}]);
//# sourceMappingURL=chunk-54d5164b.67bf9d9e.js.map